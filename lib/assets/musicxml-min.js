window.MusicXML={},MusicXML.Drawer=function(){this.x=10,this.y=0},MusicXML.Drawer.prototype.buildStave=function(){return new Vex.Flow.Stave(this.x,this.y,200)},MusicXML.Drawer.prototype.increment=function(){this.x+=200,810==this.x&&(this.x=10,this.y+=120)},MusicXML.Drawer.prototype.shouldDrawClef=function(){return 10==this.x},MusicXML.Drawer.prototype.width=200,MusicXML.engrave=function(e,t){var r=document.getElementById(e),o=new Vex.Flow.Renderer(r,Vex.Flow.Renderer.Backends.CANVAS),i=o.getContext(),n=new Vex.Flow.Stave(10,0,500);n.setContext(i).draw();var c=new MusicXML.Score(i,t);return c.render(),c},MusicXML.Measure=function(e,t){this.ctx=e,this.notes=t.note.map(function(e){return new MusicXML.Note(e)})},MusicXML.Measure.prototype.render=function(e){var t=e.buildStave();e.shouldDrawClef()&&t.addClef("alto"),t.setContext(this.ctx).draw();var r=this.notes.map(function(e){return e.toStaveNote()}),o=new Vex.Flow.Voice({num_beats:6,beat_value:8,resolution:Vex.Flow.RESOLUTION});o.addTickables(r);(new Vex.Flow.Formatter).joinVoices([o]).formatToStave([o],t);o.draw(this.ctx,t)},MusicXML.Note=function(e){this.config=e},MusicXML.Note.prototype.toStaveNote=function(){var e=new Vex.Flow.StaveNote({keys:[this.compiledPitch()],duration:this.compiledDuration()});return this.config.dot&&e.addDotToAll(),e},MusicXML.Note.prototype.compiledDuration=function(){var e;switch(this.config.type){case"whole":e="w";break;case"half":e="h";break;case"quarter":e="q";break;case"eighth":e="8";break;case"16th":e="16"}return this.config.dot&&(e+="d"),e},MusicXML.Note.prototype.compiledPitch=function(){return this.config.pitch.step.toLowerCase()+"/"+this.config.pitch.octave},MusicXML.Part=function(e,t){this.measures=t.measure.map(function(t){return new MusicXML.Measure(e,t)})},MusicXML.Part.prototype.render=function(){var e=new MusicXML.Drawer;this.measures.forEach(function(t){t.render(e),e.increment()})},MusicXML.Score=function(e,t){this.parts=t.scorePartwise.part.map(function(t){return new MusicXML.Part(e,t)})},MusicXML.Score.prototype.render=function(){this.parts.forEach(function(e){e.render()})};